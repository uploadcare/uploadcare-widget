<meta charset="UTF-8">
<script>
  UPLOADCARE_PUBLIC_KEY = "demopublickey";
  UPLOADCARE_TABS = "default huddle";
  UPLOADCARE_DEBUG_UPLOADS = true;
</script>
<script src="https://code.jquery.com/jquery-3.4.1.min.js"></script>
<script src="./uploadcare.full.js"></script>

<p>
  Weâ€™ve developed a beautiful widget for the web.
  <input type="hidden" data-images-only data-crop role="uploadcare-uploader" />
  It can do everything from drag-and-drop to selecting photos from various
  social networking sites like Facebook.
  <input
    type="hidden"
    data-tabs="facebook file url"
    role="uploadcare-uploader"
  />
</p>

<p>
  Graceful pub key:
  <input
    type="hidden"
    role="uploadcare-uploader"
    data-public-key=""
    data-multiple=""
  />
</p>

<label>
  Clearable:
  <input type="hidden" role="uploadcare-uploader" data-clearable />
</label>

<div id="last-result"></div>
<ul id="events"></ul>
<script>
  (function() {
    var log = function(text) {
      var time = new Date().toLocaleTimeString();
      const $li = document.createElement('li')

      $li.textContent = time + " " + text

      document.querySelector('#events').append(
        document.createElement('li')
      )
    };
    var widgets = uploadcare.initialize();
    for (var i = 0; i < widgets.length; i++) {
      widgets[i].onChange.add(function(file) {
        const $lastResult = document.querySelector('#last-result')
        if (file) {
          file.done(function(info) {
            log("change: " + info.uuid);
            const imgSrc = info.originalUrl + "-/preview/500x500/"

            $lastResult.innerHTML = `<img src="${imgSrc}">`
          });
        } else {
          while($lastResult.firstChild)
            $lastResult.removeChild($lastResult.firstChild)
          log("change: (empty)");
        }
      });
    }
  })()
</script>
